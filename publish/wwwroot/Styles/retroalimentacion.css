/* ================================================
   RETROALIMENTACIÓN.CSS - BEM ESTRICTO
   Módulo de Retroalimentación CCC - SWGROI
   ================================================ */

/* ================================
   VARIABLES CSS (BASE)
   ================================ */
:root {
    /* Colores primarios */
    --ui-color-primario: #1e40af;
    --ui-color-primario-hover: #1d4ed8;
    --ui-color-secundario: #64748b;
    --ui-color-texto: #1f2937;
    --ui-color-texto-muted: #6b7280;
    
    /* Colores de estado */
    --ui-color-exito: #059669;
    --ui-color-error: #dc2626;
    --ui-color-advertencia: #d97706;
    --ui-color-info: #0284c7;
    
    /* Fondos */
    --ui-color-fondo: #ffffff;
    --ui-color-fondo-alt: #f8fafc;
    --ui-color-borde: #e2e8f0;
    
    /* Espaciado */
    --ui-gap-4: 0.25rem;
    --ui-gap-8: 0.5rem;
    --ui-gap-12: 0.75rem;
    --ui-gap-16: 1rem;
    --ui-gap-24: 1.5rem;
    --ui-gap-32: 2rem;
    
    /* Tipografía */
    --ui-font-size-sm: 0.875rem;
    --ui-font-size-base: 1rem;
    --ui-font-size-lg: 1.125rem;
    --ui-font-size-xl: 1.25rem;
    
    /* Radios */
    --ui-radius-sm: 0.25rem;
    --ui-radius-base: 0.375rem;
    --ui-radius-lg: 0.5rem;
    
    /* Sombras */
    --ui-shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --ui-shadow-base: 0 1px 3px rgba(0, 0, 0, 0.1);
    --ui-shadow-lg: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Reset básico */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.5;
    color: var(--ui-color-texto);
    background: var(--ui-color-fondo-alt);
}

/* ================================
   LAYOUT Y DISPOSICIÓN
   ================================ */
.ui-layout {
    display: grid;
    grid-template-columns: 300px 1fr;
    grid-template-rows: auto 1fr;
    grid-template-areas: 
        "sidebar header"
        "sidebar main";
    min-height: 100vh;
}

.ui-layout--no-topbar {
    grid-template-areas: 
        "sidebar main"
        "sidebar main";
}

.ui-layout__main {
    grid-area: main;
    padding: var(--ui-gap-24);
    overflow-y: auto;
    background: var(--ui-color-fondo-alt);
}

/* ================================
   SIDEBAR
   ================================ */
.ui-sidebar {
    grid-area: sidebar;
    width: 300px;
    height: 100vh;
    background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
    color: white;
    padding: var(--ui-gap-24);
    overflow-y: auto;
    position: fixed;
    left: 0;
    top: 0;
}

.ui-sidebar__header {
    margin-bottom: var(--ui-gap-32);
    text-align: center;
}

.ui-sidebar__title {
    font-size: var(--ui-font-size-xl);
    font-weight: bold;
    margin: 0 0 var(--ui-gap-16) 0;
}

.ui-sidebar__logo-img {
    max-width: 120px;
    height: auto;
}

.ui-sidebar__nav {
    margin: 0;
}

.ui-sidebar__menu {
    list-style: none;
    padding: 0;
    margin: 0;
}

.ui-sidebar__item {
    margin-bottom: var(--ui-gap-8);
}

.ui-sidebar__link {
    display: block;
    padding: var(--ui-gap-12) var(--ui-gap-16);
    color: rgba(255, 255, 255, 0.9);
    text-decoration: none;
    border-radius: var(--ui-radius-base);
    transition: background-color 0.2s ease;
}

.ui-sidebar__link:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.ui-sidebar__link--active {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    font-weight: 500;
}

.ui-sidebar__link--logout {
    color: #fca5a5;
}

.ui-sidebar__link--logout:hover {
    background: rgba(220, 38, 38, 0.2);
}

/* ================================
   CARDS
   ================================ */
.ui-card {
    background: var(--ui-color-fondo);
    border-radius: var(--ui-radius-lg);
    box-shadow: var(--ui-shadow-base);
    overflow: hidden;
}

.ui-card--module {
    padding: var(--ui-gap-24);
}

.ui-card--form {
    padding: var(--ui-gap-32);
    max-width: 800px;
    margin: 0 auto;
}

.ui-card__header {
    margin-bottom: var(--ui-gap-24);
    text-align: center;
}

.ui-card__title {
    font-size: var(--ui-font-size-xl);
    font-weight: 600;
    color: var(--ui-color-texto);
    margin: 0 0 var(--ui-gap-8) 0;
}

.ui-card__subtitle {
    color: var(--ui-color-texto-muted);
    font-size: var(--ui-font-size-base);
    margin: 0;
}

/* ================================
   BREADCRUMBS
   ================================ */
.ui-breadcrumbs {
    margin-bottom: var(--ui-gap-24);
}

.ui-breadcrumbs__list {
    display: flex;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
}

.ui-breadcrumbs__item {
    display: flex;
    align-items: center;
}

.ui-breadcrumbs__link {
    color: var(--ui-color-primario);
    text-decoration: none;
    font-size: var(--ui-font-size-sm);
}

.ui-breadcrumbs__link:hover {
    text-decoration: underline;
}

.ui-breadcrumbs__separator {
    margin: 0 var(--ui-gap-8);
    color: var(--ui-color-texto-muted);
}

.ui-breadcrumbs__current {
    color: var(--ui-color-texto-muted);
    font-size: var(--ui-font-size-sm);
}

/* ================================
   FORMULARIOS
   ================================ */
.ui-form {
    display: flex;
    flex-direction: column;
    gap: var(--ui-gap-24);
}

.ui-form-group {
    display: flex;
    flex-direction: column;
    gap: var(--ui-gap-8);
}

.ui-form__label {
    font-weight: 500;
    color: var(--ui-color-texto);
    font-size: var(--ui-font-size-base);
}

.ui-form__input,
.ui-form__textarea,
.ui-form__select {
    width: 100%;
    padding: var(--ui-gap-12);
    border: 1px solid var(--ui-color-borde);
    border-radius: var(--ui-radius-base);
    font-size: var(--ui-font-size-base);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    background: var(--ui-color-fondo);
    font-family: inherit;
    box-sizing: border-box;
}

.ui-form__input:focus-visible,
.ui-form__textarea:focus-visible,
.ui-form__select:focus-visible {
    outline: none;
    border-color: var(--ui-color-primario);
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.ui-form__textarea {
    resize: vertical;
    min-height: 100px;
}

/* ================================
   BOTONES
   ================================ */
.ui-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--ui-gap-8);
    padding: var(--ui-gap-12) var(--ui-gap-24);
    border: 1px solid transparent;
    border-radius: var(--ui-radius-base);
    font-size: var(--ui-font-size-base);
    font-weight: 500;
    text-decoration: none;
    cursor: pointer;
    transition: all 0.2s ease;
    background: transparent;
    color: var(--ui-color-texto);
    font-family: inherit;
    min-height: 44px;
}

.ui-button:focus-visible {
    outline: 2px solid var(--ui-color-primario);
    outline-offset: 2px;
}

.ui-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.ui-button--primary {
    background: var(--ui-color-primario);
    color: white;
    border-color: var(--ui-color-primario);
}

.ui-button--primary:hover:not(:disabled) {
    background: var(--ui-color-primario-hover);
    border-color: var(--ui-color-primario-hover);
}

.ui-button--secondary {
    background: var(--ui-color-secundario);
    color: white;
    border-color: var(--ui-color-secundario);
}

.ui-button--secondary:hover:not(:disabled) {
    background: #475569;
}

.ui-button--block {
    width: 100%;
}

.ui-button__icon {
    font-size: 1em;
    line-height: 1;
}

/* ================================
   COMPONENTES RETROALIMENTACIÓN
   ================================ */

/* Secciones */
.retro-seccion {
    width: 100%;
}

/* Mensaje obligatorio */
.retro-obligatorio {
    background: #eff6ff;
    border: 1px solid #bfdbfe;
    border-radius: var(--ui-radius-base);
    padding: var(--ui-gap-16);
    margin-bottom: var(--ui-gap-24);
    text-align: center;
    color: var(--ui-color-info);
}

/* Formulario de respuestas */
.retro-form {
    gap: var(--ui-gap-16);
}

.retro-preguntas {
    display: flex;
    flex-direction: column;
    gap: var(--ui-gap-24);
}

.retro-pregunta {
    background: var(--ui-color-fondo-alt);
    border-radius: var(--ui-radius-base);
    padding: var(--ui-gap-24);
    border: 1px solid var(--ui-color-borde);
}

.retro-pregunta__numero {
    display: inline-block;
    background: var(--ui-color-primario);
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    text-align: center;
    line-height: 28px;
    font-size: var(--ui-font-size-sm);
    font-weight: 600;
    margin-right: var(--ui-gap-12);
}

.retro-pregunta__texto {
    font-weight: 500;
    color: var(--ui-color-texto);
    margin-bottom: var(--ui-gap-16);
    font-size: var(--ui-font-size-base);
}

.retro-pregunta__obligatorio {
    color: var(--ui-color-error);
    font-size: var(--ui-font-size-sm);
    margin-left: var(--ui-gap-4);
}

.retro-respuesta {
    margin-top: var(--ui-gap-12);
}

/* Opciones de escala */
.retro-escala {
    display: flex;
    gap: var(--ui-gap-16);
    flex-wrap: wrap;
    margin-top: var(--ui-gap-12);
}

.retro-escala__opcion {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--ui-gap-4);
    flex: 1;
    min-width: 60px;
}

.retro-escala__radio {
    appearance: none;
    width: 40px;
    height: 40px;
    border: 2px solid var(--ui-color-borde);
    border-radius: 50%;
    position: relative;
    cursor: pointer;
    transition: all 0.2s ease;
    background: var(--ui-color-fondo);
}

.retro-escala__radio:hover {
    border-color: var(--ui-color-primario);
}

.retro-escala__radio:checked {
    border-color: var(--ui-color-primario);
    background: var(--ui-color-primario);
}

.retro-escala__radio:checked::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 12px;
    height: 12px;
    background: white;
    border-radius: 50%;
}

.retro-escala__label {
    font-size: var(--ui-font-size-sm);
    color: var(--ui-color-texto-muted);
    text-align: center;
    font-weight: 500;
}

.retro-escala__radio:checked + .retro-escala__label {
    color: var(--ui-color-primario);
    font-weight: 600;
}

/* Acciones del formulario */
.retro-acciones {
    margin-top: var(--ui-gap-32);
    text-align: center;
}

/* Mensaje de éxito */
.retro-exito {
    text-align: center;
    padding: var(--ui-gap-32);
    max-width: 500px;
    margin: 0 auto;
}

.retro-exito__icono {
    font-size: 3.5rem;
    background: linear-gradient(90deg, rgba(99,102,241,0.12), rgba(59,130,246,0.08));
    color: var(--ui-color-primario);
    width:72px;
    height:72px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:12px;
}

.retro-exito__titulo { font-size:1.25rem; margin:0 0 .5rem 0; color:var(--ui-color-primario); }
.retro-exito__mensaje { color:var(--ui-color-texto-muted); margin-bottom:0.75rem }
.retro-exito__meta { color:var(--ui-color-texto); font-size:0.95rem; margin-top:0.4rem }
.retro-exito__acciones { display:flex; gap:0.5rem; margin-top:0.75rem }
.retro-exito__acciones .ui-button--secondary { background:#2563eb; border-color:#2563eb }
.retro-exito__acciones .ui-button--ghost { border-color:var(--ui-color-borde) }

/* Botón de cierre dentro de la sección de éxito */
.retro-exito__cerrar {
    min-width: 160px;
    padding: 0.6rem 1.1rem;
    border-radius: 8px;
    font-weight: 700;
    box-shadow: 0 6px 18px rgba(16,24,40,0.06);
}

/* Ajustes responsivos: apilar acciones y hacer el botón full-width en pantallas pequeñas */
@media (max-width: 480px) {
    .retro-exito__acciones { flex-direction: column; align-items: stretch; }
    .retro-exito__cerrar { width: 100%; min-width: auto; }
}

.retro-exito__icono {
    font-size: 4rem;
    margin-bottom: var(--ui-gap-16);
}

.retro-exito__titulo {
    font-size: var(--ui-font-size-xl);
    color: var(--ui-color-exito);
    margin-bottom: var(--ui-gap-16);
}

.retro-exito__mensaje {
    color: var(--ui-color-texto-muted);
    line-height: 1.6;
}

/* Mensaje de error */
.retro-error {
    text-align: center;
    padding: var(--ui-gap-32);
    max-width: 500px;
    margin: 0 auto;
}

.retro-error__icono {
    font-size: 4rem;
    margin-bottom: var(--ui-gap-16);
}

.retro-error__titulo {
    font-size: var(--ui-font-size-xl);
    color: var(--ui-color-error);
    margin-bottom: var(--ui-gap-16);
}

.retro-error__mensaje {
    color: var(--ui-color-texto-muted);
    margin-bottom: var(--ui-gap-24);
    line-height: 1.6;
}

.retro-error__acciones {
    display: flex;
    justify-content: center;
}

/* Cargando */
.retro-cargando {
    text-align: center;
    padding: var(--ui-gap-32);
    max-width: 500px;
    margin: 0 auto;
}

.retro-cargando__spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--ui-color-borde);
    border-left-color: var(--ui-color-primario);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto var(--ui-gap-16);
}

.retro-cargando__texto {
    color: var(--ui-color-texto-muted);
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Ajustes tipográficos para las preguntas: el texto principal se marca en strong */
.retro-pregunta__texto { font-size: 1rem; display: block; margin-bottom: 0.5rem; color: var(--ui-color-texto); }
.retro-pregunta__texto strong { font-weight: 800; color: var(--ui-color-primario); display: block; }

/* Mejor foco para radios personalizados */
.retro-escala__radio:focus-visible {
    outline: 3px solid rgba(30, 64, 175, 0.18);
    outline-offset: 2px;
}

/* ================================
   RESPONSIVE
   ================================ */
@media (max-width: 768px) {
    .ui-layout {
        grid-template-columns: 1fr;
        grid-template-areas: "main";
    }
    .retro-escala__label { color: var(--ui-color-texto); }
    .ui-form__textarea { font-size: 0.98rem; line-height: 1.4; }
    .ui-sidebar {
        display: none;
    }
    
    .ui-layout__main {
        padding: var(--ui-gap-16);
    }
    
    .ui-card--form {
        padding: var(--ui-gap-24);
    }
    
    .retro-escala {
        flex-direction: column;
        gap: var(--ui-gap-12);
    }
    
    .retro-escala__opcion {
        flex-direction: row;
        justify-content: flex-start;
        min-width: auto;
        gap: var(--ui-gap-12);
    }
}

/* Estados de validación - LEGACY: Ahora se usa Toast
   Estas clases se mantienen para compatibilidad pero serán removidas en futuras versiones */

/* Densidad visual optimizada */
.ui-card--module {
    padding: var(--ui-gap-16);
}

.retro-pregunta {
    padding: var(--ui-gap-16);
}

@media (min-width: 1024px) {
    .ui-card--module {
        padding: var(--ui-gap-24);
    }
    
    .retro-pregunta {
        padding: var(--ui-gap-24);
    }
}

/* Estilos añadidos desde retroalimentacion.html (migrados de inline) */
.retro-card-header { display:flex; align-items:center; justify-content:space-between; gap:1rem; }
.retro-card-header h2 { margin:0; }
.retro-progress { width:100%; height:14px; background:#eef2ff; border-radius:999px; overflow:hidden; margin-top:0.75rem; position:relative; }
.retro-progress__bar { display:block; height:100%; background:linear-gradient(90deg,#1e40af,#3b82f6); width:0%; transition:width .45s cubic-bezier(.2,.9,.3,1); border-radius:999px; }
.retro-exito__icono, .retro-error__icono { font-size:2.25rem; }
.retro-obligatorio { text-align:left; }
.retro-preguntas .retro-pregunta { margin-bottom:1rem; }
.ui-card--form { max-width:880px; margin:0 auto; }
@media (max-width:768px) { .ui-layout__main { padding:1rem; } }

/* Layout de encuesta centrada */
body.ui-layout--survey .ui-layout__main {
    display:flex;
    align-items:center;
    justify-content:center;
    padding:2.5rem;
    min-height:100vh;
    background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);
}

body.ui-layout--survey .ui-card--form {
    width:100%;
    max-width:760px;
    box-shadow: 0 6px 20px rgba(16,24,40,0.08);
    border-radius:12px;
    padding:1.5rem 2rem;
}

/* Solo permitir scroll dentro de la tarjeta del formulario en la vista de encuesta */
body.ui-layout--survey {
    overflow: hidden; /* evitar scroll en la página */
}
body.ui-layout--survey .ui-layout__main {
    overflow: hidden; /* asegurar que el main no haga scroll */
}
body.ui-layout--survey .ui-card--form {
    /* Limitar la altura para que el contenido interno sea desplazable */
    max-height: calc(100vh - 4rem);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

/* Ajustes visuales para look de encuesta */
.retro-card-header { gap:0.5rem; }
.retro-card-header h2 { font-size:1.25rem; }
.retro-obligatorio { background:#f1f5f9; border-left:4px solid #bfdbfe; padding:.75rem 1rem; border-radius:6px; }
.retro-acciones { display:flex; gap:0.75rem; justify-content:flex-end; }
.retro-acciones .ui-button--ghost { background:transparent; border:1px solid var(--ui-color-borde); }

/* Utilidad de espaciado para secciones internas */
.retro-card-spacing { margin-top:1rem; }

/* Progress meta (porcentaje + contador) */
.retro-progress-row { display:flex; align-items:center; gap:1rem; justify-content:space-between; margin-top:0.5rem }
.retro-progress__meta { display:flex; gap:0.5rem; align-items:center; justify-content:flex-start; min-width:110px }
.retro-progress__pct { font-weight:700; color:var(--ui-color-primario); transition: transform .35s cubic-bezier(.2,.9,.3,1); display:inline-block }
.retro-progress__count { color:var(--ui-color-texto-muted); font-size:0.95rem }
.retro-progress { flex:1 }

/* Label dentro de la barra (centrado) */
.retro-progress__bar-label { display:none !important; }

/* Cuando el label está visible dentro de la barra, el meta lateral queda oculto */
.retro-progress__meta--hidden { opacity: 0.0; pointer-events: none; transform: translateY(-2px); transition: opacity .25s ease; }
.retro-progress__bar-label--hidden { display:none !important; }
.retro-progress__bar-label--visible { display:none !important; }

/* utility: screen-reader only */
.sr-only { position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

/* Forzar color rojo en la leyenda principal si tiene el id específico */
#infoCliente.ui-card__subtitle--error {
    color: var(--ui-color-error) !important;
}

/* Nota secundaria para la encuesta (visible sólo si no contestada) */
#retroNota { color: var(--ui-color-texto-muted); padding:0.6rem 0; }

/* Subtitulo de tarjeta en modo error (leyenda roja) */
.ui-card__subtitle--error {
    color: #881c1c; /* texto más sobrio sobre fondo claro */
    font-weight: 700;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: #fff5f5; /* fondo rosado claro */
    padding: 0.4rem 0.6rem;
    border-left: 4px solid #dc2626;
    border-radius: 6px;
}
.ui-card__subtitle--error::before {
    content: '⚠️';
    font-size: 0.85rem; /* icono más pequeño */
    line-height: 1;
    display:inline-block;
    transform: translateY(0.05rem);
}

/* Header de pregunta con numeración */
.retro-pregunta__header {
    display:flex;
    align-items:flex-start;
    gap:0.75rem;
}

.retro-pregunta__numero {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: var(--ui-color-primario);
    color: white;
    width: 34px;
    height: 34px;
    border-radius: 50%;
    font-size: 0.95rem;
    font-weight: 700;
    flex: 0 0 34px;
    margin-top: 2px;
}

/* Panel de desarrollo para probar JSON de ejemplo */
.dev-panel {
    margin-top: 1rem;
    border: 1px dashed var(--ui-color-borde);
    padding: 0.75rem;
    background: #fff;
    border-radius: 8px;
}
.dev-panel textarea { width:100%; min-height:120px; font-family: monospace; font-size:0.95rem; padding:0.5rem; border:1px solid var(--ui-color-borde); border-radius:6px }
.dev-panel .dev-actions { margin-top:0.5rem; display:flex; gap:0.5rem; justify-content:flex-end }
.dev-toggle { font-size:0.9rem; margin-left:0.5rem }

/* Center inner question container */
.retro-preguntas { max-width:680px; margin: 0 auto; display:block; }

/* Logo in header */
.retro-logo { width:40px; height:auto; object-fit:contain; margin-right:0.6rem; vertical-align:middle; }

/* Typography and color improvements */
.retro-pregunta__texto { font-weight:700; color:var(--ui-color-primario); font-size:1rem; display:block; margin-bottom:0.5rem; }
.retro-escala__label { color:var(--ui-color-texto); font-weight:600; }
.retro-respuesta textarea { border:1px solid var(--ui-color-borde); border-radius:6px; }
.retro-respuesta textarea:focus { outline:none; box-shadow:0 0 0 4px rgba(59,130,246,0.08); border-color:var(--ui-color-primario); }

/* Subtle color tweaks for options */
.retro-escala__opcion { background: #ffffff; padding: 0.25rem; border-radius:6px; }

/* Make question text clearer on small screens */
@media (max-width:480px) {
    .retro-pregunta__texto { font-size:0.98rem; }
    .retro-logo { width:32px; }
}